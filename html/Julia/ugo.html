
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>GALAHAD UGO package &#8212; GALAHAD Julia interfaces 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/target-highlight.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ugo';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="callable functions" href="ugo_functions.html" />
    <link rel="prev" title="Global Optimization" href="go.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
    <img src="_static/galahad.small.png" class="logo__image only-light" alt="Logo image">
    <img src="_static/galahad.small.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="uco.html">
                        Unconstrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="bco.html">
                        Bound-constrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="ls.html">
                        Least-Squares
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="lp.html">
                        Linear Programming
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="qp.html">
                        Quadratic Programming
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="reg.html">
                        Regularization subproblems
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="sys.html">
                        Linear Systems
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="go.html">
                        Global Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="auxiliary.html">
                        Auxiliary Procedures
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="uco.html">
                        Unconstrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="bco.html">
                        Bound-constrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="ls.html">
                        Least-Squares
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="lp.html">
                        Linear Programming
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="qp.html">
                        Quadratic Programming
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="reg.html">
                        Regularization subproblems
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="sys.html">
                        Linear Systems
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="go.html">
                        Global Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="auxiliary.html">
                        Auxiliary Procedures
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">UGO - univariate global optimization of a smooth function over an interval</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ugo_functions.html">callable functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="bgo.html">BGO - multivariate global optimization of a smooth function within a box using stochastic methods</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="bgo_functions.html">callable functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dgo.html">DGO - multivariate global optimization of a smooth function within a box using deterministic methods</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dgo_functions.html">callable functions</a></li>
</ul>
</li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="module-galahad.ugo">
<span id="galahad-ugo-package"></span><span id="doxid-index-ugo"></span><h1>GALAHAD UGO package<a class="headerlink" href="#module-galahad.ugo" title="Permalink to this heading">#</a></h1>
<section id="purpose">
<h2>purpose<a class="headerlink" href="#purpose" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ugo</span></code> package aims to find the global minimizer of a univariate
twice-continuously differentiable function <span class="math notranslate nohighlight">\(f(x)\)</span> of a single
variable over the finite interval <span class="math notranslate nohighlight">\(x^l &lt;= x &lt;= x^u\)</span>. Function
and derivative values are provided via a subroutine call.
Second derivatives may be used to advantage if they are available.</p>
<p>See Section 4 of $GALAHAD/doc/ugo.pdf for additional details.</p>
</section>
<section id="method">
<h2>method<a class="headerlink" href="#method" title="Permalink to this heading">#</a></h2>
<p>The algorithm starts by splitting the interval <span class="math notranslate nohighlight">\([x^l,x^u]\)</span> into a specified
number of subintervals <span class="math notranslate nohighlight">\([x_i,x_{i+1}]\)</span> of equal length, and evaluating
<span class="math notranslate nohighlight">\(f\)</span> and its derivatives at each <span class="math notranslate nohighlight">\(x_i\)</span>. A surrogate (approximating)
lower bound function is constructed on each subinterval using the
function and derivative values at each end, and an estimate of the
first- and second-derivative Lipschitz constant. This surrogate is
minimized, the true objective evaluated at the best predicted point,
and the corresponding interval split again at this point.
Any interval whose surrogate lower bound value exceeds an evaluated
actual value is discarded. The method continues until only one interval
of a maximum permitted width remains.</p>
</section>
<section id="reference">
<h2>reference<a class="headerlink" href="#reference" title="Permalink to this heading">#</a></h2>
<p>Many ingredients in the algorithm are based on the paper</p>
<blockquote>
<div><p>D. Lera and Ya. D. Sergeyev,
“Acceleration of univariate global optimization algorithms working with
Lipschitz functions and Lipschitz first derivatives”
<em>SIAM J. Optimization</em> <strong>23(1)</strong>, (2013) 508–529</p>
</div></blockquote>
<p>but adapted to use second derivatives.</p>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="introduction-to-function-calls">
<h2>introduction to function calls<a class="headerlink" href="#introduction-to-function-calls" title="Permalink to this heading">#</a></h2>
<p>To solve a given problem, functions from the ugo package must be
called in the following order:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1a172105bd528410f7c7e2fd77899ebc78"><span class="std std-ref">ugo_initialize</span></a> - provide default control parameters and set up initial data structures</p></li>
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1a6819d58a728f3bf97232ed719e72fb91"><span class="std std-ref">ugo_read_specfile</span></a> (optional) - override control values by reading replacement values from a file</p></li>
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1a8bcbdf9ef1229535b77d9991eb543dcb"><span class="std std-ref">ugo_import</span></a> - set up problem data structures and fixed values</p></li>
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1a51fa6faacfb75c3dcad44befd2e6cb40"><span class="std std-ref">ugo_reset_control</span></a> (optional) - possibly change control parameters if a sequence of problems are being solved</p></li>
<li><p>solve the problem by calling one of</p>
<ul>
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1aa5b2949ab17e25a0a0c24f38c0d61a1a"><span class="std std-ref">ugo_solve_direct</span></a> - solve using function calls to evaluate function and derivative values, or</p></li>
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1a0b8f123f8e67bb0cb8a27c5ce87c824c"><span class="std std-ref">ugo_solve_reverse</span></a> - solve returning to the calling program to obtain function and derivative values</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1a8e1db35daea3247b2cc9eb8607d0abee"><span class="std std-ref">ugo_information</span></a> (optional) - recover information about the solution and solution process</p></li>
<li><p><a class="reference internal" href="ugo_functions.html#doxid-galahad-ugo-8h-1ad9485926c547bb783aea3ee1adb3b084"><span class="std std-ref">ugo_terminate</span></a> - deallocate data structures</p></li>
</ul>
<p>See the <a class="reference internal" href="#doxid-index-ugo-examples"><span class="std std-ref">examples</span></a> section for
illustrations of use.</p>
</section>
<section id="parametric-real-type-t">
<h2>parametric real type T<a class="headerlink" href="#parametric-real-type-t" title="Permalink to this heading">#</a></h2>
<p>Below, the symbol T refers to a parametric real type that may be Float32
(single precision) or Float64 (double precision).
Calable functions as described are with T as Float64, but variants
(with the additional suffix <code class="docutils literal notranslate"><span class="pre">_s</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">ugo_initialize_s</span></code>)
are available with T as Float32.</p>
</section>
<section id="callable-functions">
<h2>callable functions<a class="headerlink" href="#callable-functions" title="Permalink to this heading">#</a></h2>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1a172105bd528410f7c7e2fd77899ebc78"><span id="index-0"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_initialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span></pre>
<p>Set default control values and initialize private data</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a structure containing control information (see <a class="reference internal" href="#doxid-structugo-control-type"><span class="std std-ref">ugo_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type Int32, that gives the
exit status from the package. Possible values are
(currently):</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The initialization was successful.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1a6819d58a728f3bf97232ed719e72fb91"><span id="index-1"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_read_specfile</span><span class="p">(</span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">specfile</span><span class="p">)</span></pre>
<p>Read the content of a specification file, and assign values associated
with given keywords to the corresponding control parameters.  An
in-depth discussion of specification files is
<a class="reference internal" href="spec.html#details-spec-file"><span class="std std-ref">available</span></a>, and a detailed list of keywords
with associated default values is provided in
$GALAHAD/src/ugo/UGO.template.  See also Table 2.1 in the Fortran
documentation provided in $GALAHAD/doc/ugo.pdf for a list of how these
keywords relate to the components of the control structure.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a structure containing control information (see <a class="reference internal" href="#doxid-structugo-control-type"><span class="std std-ref">ugo_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>specfile</p></td>
<td><p>is a one-dimensional array of type Vararg{Cchar} that must give the name of the specification file</p></td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1a8bcbdf9ef1229535b77d9991eb543dcb"><span id="index-2"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_import</span><span class="p">(</span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">x_l</span><span class="p">,</span><span class="w"> </span><span class="n">x_u</span><span class="p">)</span></pre>
<p>Import problem data into internal storage prior to solution.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><dl class="simple">
<dt>is a structure whose members provide control parameters</dt><dd><p>for the remaining procedures (see
<a class="reference internal" href="#doxid-structugo-control-type"><span class="std std-ref">ugo_control_type</span></a>)</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type Int32, that gives the
exit status from the package. Possible values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>1</strong></dt><dd><p>The import was successful, and the package is ready
for the solve phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>x_l</p></td>
<td><p>is a scalar variable of type T, that holds the value <span class="math notranslate nohighlight">\(x^l\)</span> of the lower bound on the optimization variable <span class="math notranslate nohighlight">\(x\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>x_u</p></td>
<td><p>is a scalar variable of type T, that holds the value <span class="math notranslate nohighlight">\(x^u\)</span> of the upper bound on the optimization variable <span class="math notranslate nohighlight">\(x\)</span>.</p></td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1a51fa6faacfb75c3dcad44befd2e6cb40"><span id="index-3"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_reset_control</span><span class="p">(</span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span></pre>
<p>Reset control parameters after import if required.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a structure whose members provide control parameters for the remaining procedures (see <a class="reference internal" href="#doxid-structugo-control-type"><span class="std std-ref">ugo_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type Int32, that gives the
exit status from the package. Possible values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>1</strong></dt><dd><p>The import was successful, and the package is ready
for the solve phase</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1aa5b2949ab17e25a0a0c24f38c0d61a1a"><span id="index-4"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_solve_direct</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">userdata</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">eval_fgh</span><span class="p">)</span></pre>
<p>Find an approximation to the global minimizer of a given univariate
function with a Lipschitz gradient in an interval.</p>
<p>This version is for the case where all function/derivative information
is available by function calls.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>userdata</p></td>
<td><p>is a structure that allows data to be passed into the function and derivative evaluation programs (see below).</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type Int32, that gives the
entry and exit status from the package.</p>
<p>On initial entry, status must be set to 1.</p>
<p>Possible exit values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The run was successful</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-7</strong></dt><dd><p>The objective function appears to be unbounded from
below</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-18</strong></dt><dd><p>Too many iterations have been performed. This may
happen if control.maxit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-19</strong></dt><dd><p>The CPU time limit has been reached. This may happen
if control.cpu_time_limit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-40</strong></dt><dd><p>The user has forced termination of solver by
removing the file named control.alive_file from unit
unit control.alive_unit.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>is a scalar variable of type T, that holds the value of the approximate global minimizer <span class="math notranslate nohighlight">\(x\)</span> after a successful (status = 0) call.</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>is a scalar variable of type T, that holds the the value of the objective function <span class="math notranslate nohighlight">\(f(x)\)</span> at the approximate global minimizer <span class="math notranslate nohighlight">\(x\)</span> after a successful (status = 0) call.</p></td>
</tr>
<tr class="row-even"><td><p>g</p></td>
<td><p>is a scalar variable of type T, that holds the the value of the gradient of the objective function <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span> at the approximate global minimizer <span class="math notranslate nohighlight">\(x\)</span> after a successful (status = 0) call.</p></td>
</tr>
<tr class="row-odd"><td><p>h</p></td>
<td><p>is a scalar variable of type T, that holds the the value of the second derivative of the objective function <span class="math notranslate nohighlight">\(f^{\prime\prime}(x)\)</span> at the approximate global minimizer <span class="math notranslate nohighlight">\(x\)</span> after a successful (status = 0) call.</p></td>
</tr>
<tr class="row-even"><td><p>eval_fgh</p></td>
<td><p>is a user-provided function that must have the
following signature:</p>
<pre class="highlight literal-block"><span></span><span class="k">function</span><span class="w"> </span><span class="n">eval_fgh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">userdata</span><span class="p">)</span></pre>
<p>The value of the objective function <span class="math notranslate nohighlight">\(f(x)\)</span> and its
first derivative <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span> evaluated at x= <span class="math notranslate nohighlight">\(x\)</span>
must be assigned to f and g respectively, and the
function return value set to 0. In addition, if
control.second_derivatives_available has been set to
true, when calling ugo_import, the user must also
assign the value of the second derivative
<span class="math notranslate nohighlight">\(f^{\prime\prime}(x)\)</span> in h; it need not be assigned
otherwise. If the evaluation is impossible at x,
return should be set to a nonzero value.</p>
</td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1a0b8f123f8e67bb0cb8a27c5ce87c824c"><span id="index-5"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_solve_reverse</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">eval_status</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">)</span></pre>
<p>Find an approximation to the global minimizer of a given univariate
function with a Lipschitz gradient in an interval.</p>
<p>This version is for the case where function/derivative information is
only available by returning to the calling procedure.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>is a scalar variable of type Int32, that gives the
entry and exit status from the package.</p>
<p>On initial entry, status must be set to 1.</p>
<p>Possible exit values are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The run was successful</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-1</strong></dt><dd><p>An allocation error occurred. A message indicating
the offending array is written on unit
control.error, and the returned allocation status
and a string containing the name of the offending
array are held in inform.alloc_status and
inform.bad_alloc respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-2</strong></dt><dd><p>A deallocation error occurred. A message indicating
the offending array is written on unit control.error
and the returned allocation status and a string
containing the name of the offending array are held
in inform.alloc_status and inform.bad_alloc
respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-7</strong></dt><dd><p>The objective function appears to be unbounded from
below</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-18</strong></dt><dd><p>Too many iterations have been performed. This may
happen if control.maxit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-19</strong></dt><dd><p>The CPU time limit has been reached. This may happen
if control.cpu_time_limit is too small, but may also
be symptomatic of a badly scaled problem.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>-40</strong></dt><dd><p>The user has forced termination of solver by
removing the file named control.alive_file from unit
unit control.alive_unit.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>3</strong></dt><dd><p>The user should compute the objective function value
<span class="math notranslate nohighlight">\(f(x)\)</span> and its first derivative <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span>, and
then re-enter the function. The required values
should be set in f and g respectively, and
eval_status (below) should be set to 0. If the user
is unable to evaluate <span class="math notranslate nohighlight">\(f(x)\)</span> or <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span> -
for instance, if the function or its first
derivative are undefined at x - the user need not
set f or g, but should then set eval_status to a
non-zero value. This value can only occur when
control.second_derivatives_available = false.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>4</strong></dt><dd><p>The user should compute the objective function value
<span class="math notranslate nohighlight">\(f(x)\)</span> and its first two derivatives <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span>
and <span class="math notranslate nohighlight">\(f^{\prime\prime}(x)\)</span> at x= <span class="math notranslate nohighlight">\(x\)</span>, and then
re-enter the function. The required values should be
set in f, g and h respectively, and eval_status
(below) should be set to 0. If the user is unable to
evaluate <span class="math notranslate nohighlight">\(f(x)\)</span>, <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span> or
<span class="math notranslate nohighlight">\(f^{\prime\prime}(x)\)</span> - for instance, if the
function or its derivatives are undefined at x - the
user need not set f, g or h, but should then set
eval_status to a non-zero value. This value can only
occur when control.second_derivatives_available =
true.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>eval_status</p></td>
<td><p>is a scalar variable of type Int32, that is used to indicate if objective function and its derivatives can be provided (see above).</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>is a scalar variable of type T, that holds the next value of <span class="math notranslate nohighlight">\(x\)</span> at which the user is required to evaluate the objective (and its derivatives) when status &gt; 0, or the value of the approximate global minimizer when status = 0</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>is a scalar variable of type T, that must be set by the user to hold the value of <span class="math notranslate nohighlight">\(f(x)\)</span> if required by status &gt; 0 (see above), and will return the value of the approximate global minimum when status = 0</p></td>
</tr>
<tr class="row-even"><td><p>g</p></td>
<td><p>is a scalar variable of type T, that must be set by the user to hold the value of <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span> if required by status &gt; 0 (see above), and will return the value of the first derivative of <span class="math notranslate nohighlight">\(f\)</span> at the approximate global minimizer when status = 0</p></td>
</tr>
<tr class="row-odd"><td><p>h</p></td>
<td><p>is a scalar variable of type T, that must be set by the user to hold the value of <span class="math notranslate nohighlight">\(f^{\prime\prime}(x)\)</span> if required by status &gt; 0 (see above), and will return the value of the second derivative of <span class="math notranslate nohighlight">\(f\)</span> at the approximate global minimizer when status = 0</p></td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1a8e1db35daea3247b2cc9eb8607d0abee"><span id="index-6"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_information</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">inform</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span></pre>
<p>Provides output information</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>inform</p></td>
<td><p>is a structure containing output information (see <a class="reference internal" href="#doxid-structugo-inform-type"><span class="std std-ref">ugo_inform_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type Int32, that gives the
exit status from the package. Possible values are
(currently):</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>0</strong></dt><dd><p>The values were recorded successfully</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-ugo-8h-1ad9485926c547bb783aea3ee1adb3b084"><span id="index-7"></span><span></span><span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">ugo_terminate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">inform</span><span class="p">)</span></pre>
<p>Deallocate all internal private storage</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a structure containing control information (see <a class="reference internal" href="#doxid-structugo-control-type"><span class="std std-ref">ugo_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>inform</p></td>
<td><p>is a structure containing output information (see <a class="reference internal" href="#doxid-structugo-inform-type"><span class="std std-ref">ugo_inform_type</span></a>)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="available-structures">
<h2>available structures<a class="headerlink" href="#available-structures" title="Permalink to this heading">#</a></h2>
</section>
<section id="ugo-control-type-structure">
<span id="doxid-structugo-control-type"></span><span id="index-8"></span><h2>ugo_control_type structure<a class="headerlink" href="#ugo-control-type-structure" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="w">    </span><span class="k">struct</span> <span class="kt">ugo_control_type</span><span class="p">{</span><span class="kt">T</span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">error</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">out</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">print_level</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">start_print</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">stop_print</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">print_gap</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">maxit</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">initial_points</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">storage_increment</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">buffer</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">lipschitz_estimate_used</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">next_interval_selection</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">refine_with_newton</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">alive_unit</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">alive_file</span><span class="o">::</span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">stop_length</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">small_g_for_newton</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">small_g</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">obj_sufficient</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">global_lipschitz_constant</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">reliability_parameter</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">lipschitz_lower_bound</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">cpu_time_limit</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">clock_time_limit</span><span class="o">::</span><span class="kt">T</span><span class="w"></span>
<span class="w">      </span><span class="n">second_derivative_available</span><span class="o">::</span><span class="kt">Bool</span><span class="w"></span>
<span class="w">      </span><span class="n">space_critical</span><span class="o">::</span><span class="kt">Bool</span><span class="w"></span>
<span class="w">      </span><span class="n">deallocate_error_fatal</span><span class="o">::</span><span class="kt">Bool</span><span class="w"></span>
<span class="w">      </span><span class="n">prefix</span><span class="o">::</span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span></pre>
</section>
<section id="detailed-documentation">
<span id="details-structugo-control-type"></span><h2>detailed documentation<a class="headerlink" href="#detailed-documentation" title="Permalink to this heading">#</a></h2>
<p>control derived type as a Julia structure</p>
<section id="components">
<h3>components<a class="headerlink" href="#components" title="Permalink to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a11614f44ef4d939bdd984953346a7572"><span id="index-9"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">error</span></pre>
<p>error and warning diagnostics occur on stream error</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1aa8000eda101cade7c6c4b913fce0cc9c"><span id="index-10"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">out</span></pre>
<p>general output occurs on stream out</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a12dae630bd8f5d2d00f6a86d652f5c81"><span id="index-11"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">print_level</span></pre>
<p>the level of output required. Possible values are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\leq\)</span> 0 no output,</p></li>
<li><p>1 a one-line summary for every improvement</p></li>
<li><p>2 a summary of each iteration</p></li>
<li><p><span class="math notranslate nohighlight">\(\geq\)</span> 3 increasingly verbose (debugging) output</p></li>
</ul>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1ae0eb21dc79b53664e45ce07c9109b3aa"><span id="index-12"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">start_print</span></pre>
<p>any printing will start on this iteration</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a9a3d9960a04602d2a18009c82ae2124e"><span id="index-13"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">stop_print</span></pre>
<p>any printing will stop on this iteration</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a31edaef6b722ef2721633484405a649b"><span id="index-14"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">print_gap</span></pre>
<p>the number of iterations between printing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1ab717630b215f0362699acac11fb3652c"><span id="index-15"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">maxit</span></pre>
<p>the maximum number of iterations allowed</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a31cfe38db49ce764d93d56ea80a21bf5"><span id="index-16"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">initial_points</span></pre>
<p>the number of initial (uniformly-spaced) evaluation points (&lt;2 reset to 2)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a1b1bbeca4053127c0829ac6e28505faf"><span id="index-17"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">storage_increment</span></pre>
<p>incremenets of storage allocated (less that 1000 will be reset to 1000)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a0c7afc3fbe2c84da5f8852c76839b03b"><span id="index-18"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">buffer</span></pre>
<p>unit for any out-of-core writing when expanding arrays</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1ab4b797b153fd1ac00231b032263276b1"><span id="index-19"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">lipschitz_estimate_used</span></pre>
<p>what sort of Lipschitz constant estimate will be used:</p>
<ul class="simple">
<li><p>1 = global contant provided</p></li>
<li><p>2 = global contant estimated</p></li>
<li><p>3 = local costants estimated</p></li>
</ul>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a6a3ba03a92a96dfc5cd1c094e1e3bf87"><span id="index-20"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">next_interval_selection</span></pre>
<p>how is the next interval for examination chosen:</p>
<ul class="simple">
<li><p>1 = traditional</p></li>
<li><p>2 = local_improvement</p></li>
</ul>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a6618fb3c3e71213bde65602fc84b92ac"><span id="index-21"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">refine_with_newton</span></pre>
<p>try refine_with_newton Newton steps from the vacinity of the global minimizer to try to improve the estimate</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a3fc6359d77a53a63d57ea600b51eac13"><span id="index-22"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">alive_unit</span></pre>
<p>removal of the file alive_file from unit alive_unit terminates execution</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1ac631699a26f321b14dbed37115f3c006"><span id="index-23"></span><span></span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span><span class="w"> </span><span class="n">alive_file</span></pre>
<p>see alive_unit</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a6bf05a14c29051133abf2e66de24e460"><span id="index-24"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">stop_length</span></pre>
<p>overall convergence tolerances. The iteration will terminate when the step is less than .stop_length</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1af8026b35c403d956d877121aa8ec4e7c"><span id="index-25"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">small_g_for_newton</span></pre>
<p>if the absolute value of the gradient is smaller than small_g_for_newton, the next evaluation point may be at a Newton estimate of a local minimizer</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a7c2cf28f2ca5d11f2a013be0a3661e69"><span id="index-26"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">small_g</span></pre>
<p>if the absolute value of the gradient at the end of the interval search is smaller than small_g, no Newton serach is necessary</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a307b3c1c0f3796e8195b2339b6082b3b"><span id="index-27"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">obj_sufficient</span></pre>
<p>stop if the objective function is smaller than a specified value</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a1a37c2054aa6a285605bbfa6f0d5b73b"><span id="index-28"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">global_lipschitz_constant</span></pre>
<p>the global Lipschitz constant for the gradient (-ve means unknown)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a73f576b3c9911d11606f473feb090825"><span id="index-29"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">reliability_parameter</span></pre>
<p>the reliability parameter that is used to boost insufficiently large estimates of the Lipschitz constant (-ve means that default values will be chosen depending on whether second derivatives are provided or not)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1aa114fdc06a2a81b1274d165448caa99e"><span id="index-30"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">lipschitz_lower_bound</span></pre>
<p>a lower bound on the Lipscitz constant for the gradient (not zero unless the function is constant)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a52f14ff3f85e6805f2373eef5d0f3dfd"><span id="index-31"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">cpu_time_limit</span></pre>
<p>the maximum CPU time allowed (-ve means infinite)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1ab05d7c2b06d3a9fb085fa3739501d1c8"><span id="index-32"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">clock_time_limit</span></pre>
<p>the maximum elapsed clock time allowed (-ve means infinite)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1ab91fc45050afb092b9f27ab2910b90d1"><span id="index-33"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">second_derivative_available</span></pre>
<p>if .second_derivative_available is true, the user must provide them when requested. The package is generally more effective if second derivatives are available.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a957fc1f4f26eeef3b0951791ff972e8d"><span id="index-34"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">space_critical</span></pre>
<p>if .space_critical is true, every effort will be made to use as little space as possible. This may result in longer computation time</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a58a2c67fad6e808e8365eff67700cba5"><span id="index-35"></span><span></span><span class="kt">Bool</span><span class="w"> </span><span class="n">deallocate_error_fatal</span></pre>
<p>if .deallocate_error_fatal is true, any array/pointer deallocation error will terminate execution. Otherwise, computation will continue</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-control-type-1a1dc05936393ba705f516a0c275df4ffc"><span id="index-36"></span><span></span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">31</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span><span class="w"> </span><span class="n">prefix</span></pre>
<p>all output lines will be prefixed by .prefix(2:LEN(TRIM(.prefix))-1) where .prefix contains the required string enclosed in quotes, e.g. “string” or ‘string’</p>
</section>
</section>
<section id="ugo-time-type-structure">
<span id="doxid-structugo-time-type"></span><span id="index-37"></span><h2>ugo_time_type structure<a class="headerlink" href="#ugo-time-type-structure" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="w">    </span><span class="k">struct</span> <span class="kt">ugo_time_type</span><span class="p">{</span><span class="kt">T</span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">total</span><span class="o">::</span><span class="kt">Float32</span><span class="w"></span>
<span class="w">      </span><span class="n">clock_total</span><span class="o">::</span><span class="kt">T</span></pre>
</section>
<section id="details-structugo-time-type">
<span id="id1"></span><h2>detailed documentation<a class="headerlink" href="#details-structugo-time-type" title="Permalink to this heading">#</a></h2>
<p>time derived type as a Julia structure</p>
<section id="id2">
<h3>components<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-time-type-1aa7b2ccce10ffc8ef240d5be56ec1fbbc"><span id="index-38"></span><span></span><span class="kt">Float32</span><span class="w"> </span><span class="n">total</span></pre>
<p>the total CPU time spent in the package</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-time-type-1ae9145eea8e19f9cae77904d3d00c5d1f"><span id="index-39"></span><span></span><span class="n">T</span><span class="w"> </span><span class="n">clock_total</span></pre>
<p>the total clock time spent in the package</p>
</section>
</section>
<section id="ugo-inform-type-structure">
<span id="doxid-structugo-inform-type"></span><span id="index-40"></span><h2>ugo_inform_type structure<a class="headerlink" href="#ugo-inform-type-structure" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="w">    </span><span class="k">struct</span> <span class="kt">ugo_inform_type</span><span class="p">{</span><span class="kt">T</span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">status</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">eval_status</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">alloc_status</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">bad_alloc</span><span class="o">::</span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">81</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">iter</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">f_eval</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">g_eval</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">h_eval</span><span class="o">::</span><span class="kt">Int32</span><span class="w"></span>
<span class="w">      </span><span class="n">time</span><span class="o">::</span><span class="kt">ugo_time_type</span><span class="p">{</span><span class="kt">T</span><span class="p">}</span></pre>
</section>
<section id="details-structugo-inform-type">
<span id="id3"></span><h2>detailed documentation<a class="headerlink" href="#details-structugo-inform-type" title="Permalink to this heading">#</a></h2>
<p>inform derived type as a Julia structure</p>
<section id="id4">
<h3>components<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1a6e27f49150e9a14580fb313cc2777e00"><span id="index-41"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">status</span></pre>
<p>return status. See UGO_solve for details</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1a7b88f94f39913a54e69ea23c12d3e4bd"><span id="index-42"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">eval_status</span></pre>
<p>evaluation status for reverse communication interface</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1a4335d5f44067aca76d5fff71eeb7d381"><span id="index-43"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">alloc_status</span></pre>
<p>the status of the last attempted allocation/deallocation</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1a19ba64e8444ca3672abd157e4f1303a3"><span id="index-44"></span><span></span><span class="kt">NTuple</span><span class="p">{</span><span class="mi">81</span><span class="p">,</span><span class="kt">Cchar</span><span class="p">)</span><span class="w"> </span><span class="kt">bad_alloc</span></pre>
<p>the name of the array for which an allocation/deallocation error occurred</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1aab6f168571c2073e01e240524b8a3da0"><span id="index-45"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">iter</span></pre>
<p>the total number of iterations performed</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1aa9c29d7119d66d8540900c7531b2dcfa"><span id="index-46"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">f_eval</span></pre>
<p>the total number of evaluations of the objective function</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1acd459eb95ff0f2d74e9cc3931d8e5469"><span id="index-47"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">g_eval</span></pre>
<p>the total number of evaluations of the gradient of the objective function</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1af1410cb1718f2a083dd8a7dee9ab643a"><span id="index-48"></span><span></span><span class="kt">Int32</span><span class="w"> </span><span class="n">h_eval</span></pre>
<p>the total number of evaluations of the Hessian of the objective function</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structugo-inform-type-1a9113f4cf33f961d4a1a97455a054eac6"><span id="index-49"></span><span></span><span class="kt">ugo_time_type</span><span class="p">{</span><span class="kt">T</span><span class="p">}</span><span class="w"> </span><a class="reference internal" href="#doxid-structugo-time-type"><span class="std std-ref">ugo_time_type</span></a><span></span><span class="w"> </span><span class="n">time</span></pre>
<p>timings (see above)</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></div>
</div>
</section>
</section>
<section id="example-calls">
<span id="doxid-index-ugo-examples"></span><h2>example calls<a class="headerlink" href="#example-calls" title="Permalink to this heading">#</a></h2>
<p>This is an example of how to use the package to minimize a univariate function;
the code is available in $GALAHAD/src/ugo/Julia/test_ugo.jl .</p>
<div class="code julia highlight-default notranslate"><div class="highlight"><pre><span></span># test_ugo.jl
# Simple code to test the Julia interface to UGO

using GALAHAD
using Printf

# Test problem objective
function objf(x)
  a = 10.0
  res = x * x * cos( a*x )
  return Ref{Float64}(res)
end

# Test problem first derivative
function gradf(x)
  a = 10.0
  res = - a * x * x * sin( a*x ) + 2.0 * x * cos( a*x )
  return Ref{Float64}(res)
end

# Test problem second derivative
function hessf(x)
  a = 10.0
  res = - a * a* x * x * cos( a*x ) - 4.0 * a * x * sin( a*x ) + 2.0 * cos( a*x )
  return Ref{Float64}(res)
end

# Derived types
data = [Ptr{Ptr{Cvoid}}()]
control = ugo_control_type{Float64}()
inform = ugo_inform_type{Float64}()

# Initialize UGO
status = Ref{Cint}()
eval_status = Ref{Cint}()
ugo_initialize( data, control, status )

# Set user-defined control options
control.print_level = 1

# control.prefix = &quot;&#39;ugo: &#39;&quot;
control.prefix = (34, 39, 117, 103, 111, 58, 32, 39, 34, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 0)

# Read options from specfile
specfile = &quot;UGO.SPC&quot;
ugo_read_specfile(control, specfile)

# Test problem bounds
x_l = Ref{Float64}(-1.0)
x_u = Ref{Float64}(2.0)

# Test problem objective, gradient, Hessian values
global x = Ref{Float64}(0.0)
global f = Ref{Float64}(0.0)
global g = Ref{Float64}(0.0)
global h = Ref{Float64}(0.0)

# import problem data
ugo_import( control, data, status, x_l, x_u )

# Set for initial entry
status = Ref{Cint}(1)

# Solve the problem: min f(x), x_l ≤ x ≤ x_u
while true

  # Call UGO_solve
  ugo_solve_reverse(data, status, eval_status, x, f, g, h )

  # Evaluate f(x) and its derivatives as required
  if (status[] ≥ 2)  # need objective
    global f = objf(x[])
    if (status[] ≥ 3)  # need first derivative
      global g = gradf(x[])
      if (status[] ≥ 4) # need second derivative
        global h = hessf(x[])
      end
    end
  else  # the solution has been found (or an error has occured)
    break
  end
end

# Record solution information
ugo_information( data, inform, status )

if inform.status == 0
  @printf(&quot;%i evaluations. Optimal objective value = %5.2f status = %1i\n&quot;, inform.f_eval, f[], inform.status)
else
  @printf(&quot;BGO_solve exit status = %1i\n&quot;, inform.status)
end

# Delete internal workspace
ugo_terminate( data, control, inform )
</pre></div>
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="go.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Global Optimization</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="ugo_functions.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">callable functions</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#purpose">
   purpose
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method">
   method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reference">
   reference
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-function-calls">
   introduction to function calls
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametric-real-type-t">
   parametric real type T
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#callable-functions">
   callable functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#available-structures">
   available structures
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ugo-control-type-structure">
   ugo_control_type structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detailed-documentation">
   detailed documentation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#components">
     components
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ugo-time-type-structure">
   ugo_time_type structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#details-structugo-time-type">
   detailed documentation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     components
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ugo-inform-type-structure">
   ugo_inform_type structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#details-structugo-inform-type">
   detailed documentation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     components
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-calls">
   example calls
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="_sources/ugo.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright Gould/Orban/Toint, for GALAHAD productions, GALAHAD 4 C/Python interfaces copyright Fowkes/Gould, Julia interfaces  copyright Fowkes/Gould/Montoison/Orban.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>