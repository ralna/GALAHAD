
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>GALAHAD LSTR package &#8212; GALAHAD C interfaces 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/target-highlight.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}})</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lstr';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="overview of functions provided" href="lstr_functions.html" />
    <link rel="prev" title="llst_time_type structure" href="struct_llst_time_type.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
    <img src="_static/galahad.small.png" class="logo__image only-light" alt="Logo image">
    <img src="_static/galahad.small.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="uco.html">
                        Unconstrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="bco.html">
                        Bound-constrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="ls.html">
                        Least-Squares
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="lp.html">
                        Linear Programming
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="qp.html">
                        Quadratic Programming
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="reg.html">
                        Regularization subproblems
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="sys.html">
                        Linear Systems
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="go.html">
                        Global Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="auxiliary.html">
                        Auxiliary Procedures
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="uco.html">
                        Unconstrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="bco.html">
                        Bound-constrained Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="ls.html">
                        Least-Squares
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="lp.html">
                        Linear Programming
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="qp.html">
                        Quadratic Programming
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="reg.html">
                        Regularization subproblems
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="sys.html">
                        Linear Systems
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="go.html">
                        Global Optimization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="auxiliary.html">
                        Auxiliary Procedures
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="trs.html">TRS - global minization of a quadratic function within an ellipsoid using matrix factorization</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="trs_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trs_control_type.html">trs_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trs_inform_type.html">trs_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_trs_time_type.html">trs_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trs_control_type.html">trs_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trs_inform_type.html">trs_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_trs_time_type.html">trs_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="rqs.html">RQS - global minization of a regularized quadratic function using matrix factorization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="rqs_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_rqs_control_type.html">rqs_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_rqs_inform_type.html">rqs_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_rqs_time_type.html">rqs_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_rqs_control_type.html">rqs_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_rqs_inform_type.html">rqs_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_rqs_time_type.html">rqs_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dps.html">DPS - global minization of a regularized quadratic function in a diagonalising norm using matrix factorization</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="dps_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_dps_control_type.html">dps_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_dps_inform_type.html">dps_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_dps_time_type.html">dps_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_dps_control_type.html">dps_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_dps_inform_type.html">dps_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_dps_time_type.html">dps_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="gltr.html">GLTR - global minization of a quadratic function within an ellipsoid using an iterative method</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="gltr_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_gltr_control_type.html">gltr_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_gltr_inform_type.html">gltr_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_gltr_control_type.html">gltr_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_gltr_inform_type.html">gltr_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="glrt.html">GLRT - global minization of a regularized quadratic function</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="glrt_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_glrt_control_type.html">glrt_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_glrt_inform_type.html">glrt_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_glrt_control_type.html">glrt_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_glrt_inform_type.html">glrt_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-36"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="llsr.html">LLSR - global minization of a regularized linear least-squares objective using matrix factorizations</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-37"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="llsr_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-38"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llsr_control_type.html">llsr_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-39"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llsr_inform_type.html">llsr_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-40"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llsr_time_type.html">llsr_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-41"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llsr_control_type.html">llsr_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-42"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llsr_inform_type.html">llsr_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-43"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llsr_time_type.html">llsr_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-44"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="llst.html">LLST - global minization of a linear least-squares objective within an ellipsoid using matrix factorizations</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-45"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="llst_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-46"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llst_control_type.html">llst_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-47"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llst_inform_type.html">llst_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-48"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_llst_time_type.html">llst_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-49"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llst_control_type.html">llst_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-50"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llst_inform_type.html">llst_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-51"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_llst_time_type.html">llst_time_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-52"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">LSTR - global minization of a linear least-squares objective within a sphere using an iterative method</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-53" name="toctree-checkbox-53" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-53"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="lstr_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-54" name="toctree-checkbox-54" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-54"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lstr_control_type.html">lstr_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-55" name="toctree-checkbox-55" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-55"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lstr_inform_type.html">lstr_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-56" name="toctree-checkbox-56" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-56"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lstr_control_type.html">lstr_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-57" name="toctree-checkbox-57" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-57"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lstr_inform_type.html">lstr_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-58" name="toctree-checkbox-58" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-58"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lsrt.html">LSRT - global minization of a regularized linear least-squares objective using an iterative method</a><input class="toctree-checkbox" id="toctree-checkbox-59" name="toctree-checkbox-59" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-59"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="lsrt_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-60" name="toctree-checkbox-60" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-60"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lsrt_control_type.html">lsrt_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-61" name="toctree-checkbox-61" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-61"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_lsrt_inform_type.html">lsrt_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-62" name="toctree-checkbox-62" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-62"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lsrt_control_type.html">lsrt_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-63" name="toctree-checkbox-63" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-63"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_lsrt_inform_type.html">lsrt_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-64" name="toctree-checkbox-64" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-64"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="l2rt.html">L2RT - global minization of a regularized linear least-Euclidean-norm objective using an iterative method</a><input class="toctree-checkbox" id="toctree-checkbox-65" name="toctree-checkbox-65" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-65"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="l2rt_functions.html">overview of functions provided</a><input class="toctree-checkbox" id="toctree-checkbox-66" name="toctree-checkbox-66" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-66"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_l2rt_control_type.html">l2rt_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-67" name="toctree-checkbox-67" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-67"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l3 has-children"><a class="reference internal" href="struct_l2rt_inform_type.html">l2rt_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-68" name="toctree-checkbox-68" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-68"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>


<li class="toctree-l2 has-children"><a class="reference internal" href="struct_l2rt_control_type.html">l2rt_control_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-69" name="toctree-checkbox-69" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-69"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

<li class="toctree-l2 has-children"><a class="reference internal" href="struct_l2rt_inform_type.html">l2rt_inform_type structure</a><input class="toctree-checkbox" id="toctree-checkbox-70" name="toctree-checkbox-70" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-70"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>

</ul>
</li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="module-galahad.lstr">
<span id="galahad-lstr-package"></span><span id="doxid-index-lstr"></span><h1>GALAHAD LSTR package<a class="headerlink" href="#module-galahad.lstr" title="Permalink to this heading">#</a></h1>
<section id="purpose">
<h2>purpose<a class="headerlink" href="#purpose" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">lstr</span></code> package uses a <strong>Krylov-subspace iteration</strong> to find an
approximation of the global minimizer of the
<strong>linear sum-of-squares objective function</strong>
within a <strong>sphere</strong>; this is commonly known as the
<strong>linear least-squares trust-region subproblem</strong>.
The aim is to minimize the least-squares objective function
<div class="math notranslate nohighlight">
\[q(x) = \frac{1}{2}\|Ax - b\|_2^2,\]</div>

where the vector <span class="math notranslate nohighlight">\(x\)</span> is required to satisfy
the spherical <strong>trust-region constraint</strong> <span class="math notranslate nohighlight">\(\|x\|_2 \leq  \Delta\)</span>,
where the <span class="math notranslate nohighlight">\(\ell_2\)</span>-norm of <span class="math notranslate nohighlight">\(x\)</span> is defined to be <span class="math notranslate nohighlight">\(\|x\|_2 = \sqrt{x^T x}\)</span>,
and where the <strong>radius</strong> <span class="math notranslate nohighlight">\(\Delta &gt; 0\)</span>.
The method may be suitable for large problems as no factorization is
required. Reverse communication is used to obtain
matrix-vector products of the form <span class="math notranslate nohighlight">\(u + A v\)</span> and <span class="math notranslate nohighlight">\(v + A^T u.\)</span></p>
<p>See Section 4 of $GALAHAD/doc/lstr.pdf for additional details.</p>
</section>
<section id="method">
<h2>method<a class="headerlink" href="#method" title="Permalink to this heading">#</a></h2>
<p>The required solution <span class="math notranslate nohighlight">\(x\)</span> necessarily satisfies the optimality condition
<span class="math notranslate nohighlight">\(A^T ( A x - b ) + \lambda x = 0\)</span>, where <span class="math notranslate nohighlight">\(\lambda \geq 0\)</span>
is a Lagrange multiplier corresponding to the trust-region constraint
<span class="math notranslate nohighlight">\(\|x\|_2  \leq  \Delta\)</span>.</p>
<p>The method is iterative. Starting  with the vector <span class="math notranslate nohighlight">\(u_1 = b\)</span>, a
bi-diagonalisation process is used to generate the vectors <span class="math notranslate nohighlight">\(v_k\)</span> and
<span class="math notranslate nohighlight">\(u_k+1\)</span> so that the <span class="math notranslate nohighlight">\(n\)</span> by <span class="math notranslate nohighlight">\(k\)</span> matrix <span class="math notranslate nohighlight">\(V_k = ( v_1 \ldots v_k)\)</span>
and the <span class="math notranslate nohighlight">\(m\)</span> by <span class="math notranslate nohighlight">\((k+1)\)</span> matrix <span class="math notranslate nohighlight">\(U_k = ( u_1 \ldots u_{k+1})\)</span>
together satisfy
<div class="math notranslate nohighlight">
\[A V_k = U_{k+1} B_k \;\;\mbox{and}\;\;  b = \|b\| U_{k+1} e_1,\]</div>

where <span class="math notranslate nohighlight">\(B_k\)</span> is <span class="math notranslate nohighlight">\((k+1)\)</span> by <span class="math notranslate nohighlight">\(k\)</span> and lower bi-diagonal, <span class="math notranslate nohighlight">\(U_k\)</span> and
<span class="math notranslate nohighlight">\(V_k\)</span> have orthonormal columns and <span class="math notranslate nohighlight">\(e_1\)</span> is the first unit vector.
The solution sought is of the form <span class="math notranslate nohighlight">\(x_k = V_k y_k\)</span>, where <span class="math notranslate nohighlight">\(y_k\)</span>
solves the bi-diagonal least-squares trust-region problem
<div class="math notranslate nohighlight">
\[\min \| B_k y - \|b\| e_1 \|_2 \;\;\mbox{subject to}\;\;
\|y\|_2 \leq \Delta.\;\;\mbox{(1)}\]</div>
</p>
<p>If the trust-region constraint is inactive, the solution <span class="math notranslate nohighlight">\(y_k\)</span>
may be found, albeit indirectly, via the LSQR algorithm of Paige and Saunders
which solves the bi-diagonal least-squares problem
<div class="math notranslate nohighlight">
\[\min \| B_k y - \|b\| e_1 \|_2\]</div>

using a QR factorization of <span class="math notranslate nohighlight">\(B_k\)</span>. Only the most recent <span class="math notranslate nohighlight">\(v_k\)</span> and <span class="math notranslate nohighlight">\(u_{k+1}\)</span>
are required, and their predecessors discarded, to compute <span class="math notranslate nohighlight">\(x_k\)</span> from
<span class="math notranslate nohighlight">\(x_{k-1}\)</span>. This method has the important property that the iterates
<span class="math notranslate nohighlight">\(y\)</span> (and thus <span class="math notranslate nohighlight">\(x_k\)</span>) generated increase in norm with <span class="math notranslate nohighlight">\(k\)</span>. Thus
as soon as an LSQR iterate lies outside the trust-region, the required solution
to (1) and thus to the original problem must lie on the boundary of the
trust-region.</p>
<p>If the solution is so constrained, the simplest strategy is to interpolate
the last interior iterate with the newly discovered exterior one to find the
boundary point — the so-called Steihaug-Toint point — between them.
Once the solution is known to lie on the trust-region boundary,
further improvement may be made by solving
<div class="math notranslate nohighlight">
\[\min \| B_k y - \|b\| e_1 \|_2
\;\;\mbox{subject to}\;\; \|y\|_2 = \Delta,\]</div>

for which the optimality conditions require that <span class="math notranslate nohighlight">\(y_k = y(\lambda_k)\)</span>
where <span class="math notranslate nohighlight">\(\lambda_k\)</span> is the positive root of
<div class="math notranslate nohighlight">
\[B_k^T ( B_k^{} y(\lambda) - \|b\| e_1^{} ) + \lambda
y(\lambda) = 0 \;\;\mbox{and}\;\;  \|y(\lambda)\|_2 = \Delta\]</div>

The vector <span class="math notranslate nohighlight">\(y(\lambda)\)</span> is equivalently the solution to the
regularized least-squares problem
<div class="math notranslate nohighlight">
\[\begin{split}\min \left \| \left(\begin{array}{c}
B_k \\ \lambda^{1/2} I
\end{array}\right) y - \|b\| e_1^{} \right \|_2\end{split}\]</div>

and may be found efficiently. Given  <span class="math notranslate nohighlight">\(y(\lambda)\)</span>, Newton’s method
is then used to find <span class="math notranslate nohighlight">\(\lambda_k\)</span> as the positive root of
<span class="math notranslate nohighlight">\(\|y(\lambda)\|_2 = \Delta\)</span>. Unfortunately, unlike when the solution
lies in the interior of the trust-region, it is not known how to recur
<span class="math notranslate nohighlight">\(x_k\)</span> from <span class="math notranslate nohighlight">\(x_{k-1}\)</span> given <span class="math notranslate nohighlight">\(y_k\)</span>, and a second pass in which
<span class="math notranslate nohighlight">\(x_k = V_k y_k\)</span> is regenerated is needed — this need only be done
once <span class="math notranslate nohighlight">\(x_k\)</span> has implicitly deemed to be sufficiently close to optimality.
As this second pass is an additional expense, a record is kept of the
optimal objective function values for each value of <span class="math notranslate nohighlight">\(k\)</span>, and the second
pass is only performed so far as to ensure a given fraction of the
final optimal objective value. Large savings may be made in the second
pass by choosing the required fraction to be significantly smaller than one.</p>
</section>
<section id="references">
<h2>references<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<p>A complete description of the unconstrained case is given by</p>
<blockquote>
<div><p>C. C. Paige and M. A. Saunders,
<a href="#id1"><span class="problematic" id="id2">``</span></a>LSQR: an algorithm for sparse linear equations and sparse least  squares’’.
<em>ACM Transactions on Mathematical Software</em> <strong>8(1</strong> (1982) 43–71,</p>
</div></blockquote>
<p>and</p>
<blockquote>
<div><p>C. C. Paige and M. A. Saunders,
<a href="#id3"><span class="problematic" id="id4">``</span></a>ALGORITHM 583: LSQR: an algorithm for sparse linear equations and
sparse least squares’’.
<em>ACM Transactions on Mathematical Software</em> <strong>8(2)</strong> (1982) 195–209.</p>
</div></blockquote>
<p>Additional details on how to proceed once the trust-region constraint is
encountered are described in detail in</p>
<blockquote>
<div><p>C. Cartis, N. I. M. Gould and Ph. L. Toint,
<a href="#id5"><span class="problematic" id="id6">``</span></a>Trust-region and other regularisation of linear
least-squares problems’’.
<em>BIT</em> <strong>49(1)</strong> (2009) 21-53.</p>
</div></blockquote>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="introduction-to-function-calls">
<h2>introduction to function calls<a class="headerlink" href="#introduction-to-function-calls" title="Permalink to this heading">#</a></h2>
<p>To solve a given problem, functions from the lstr package must be
called in the following order:</p>
<ul class="simple">
<li><p><a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1ae423bf7ffc77c89f461448ca1f5c286c"><span class="std std-ref">lstr_initialize</span></a> - provide default control parameters and set up initial data structures</p></li>
<li><p><a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1a3d3fa989fe4c3b40cd7e296249d2205d"><span class="std std-ref">lstr_read_specfile</span></a> (optional) - override control values by reading replacement values from a file</p></li>
<li><p><a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1a1a8ad63d944dc046fd2040554d6d01e5"><span class="std std-ref">lstr_import_control</span></a> - import control parameters prior to solution</p></li>
<li><p><a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1af3355e5a8df63a9c7173eb974a1e7562"><span class="std std-ref">lstr_solve_problem</span></a> - solve the problem by reverse communication, a sequence of calls are made under control of a status parameter, each exit either asks the user to provide additional informaton and to re-enter, or reports that either the solution has been found or that an error has occurred</p></li>
<li><p><a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1a5929f00ea00af253ede33a6749451481"><span class="std std-ref">lstr_information</span></a> (optional) - recover information about the solution and solution process</p></li>
<li><p><a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1aa198189942e179e52699e1fedfcdf9d1"><span class="std std-ref">lstr_terminate</span></a> - deallocate data structures</p></li>
</ul>
<p>See the <a class="reference internal" href="#doxid-index-lstr-examples"><span class="std std-ref">examples</span></a> section for
illustrations of use.</p>
</section>
<section id="callable-functions">
<h2>callable functions<a class="headerlink" href="#callable-functions" title="Permalink to this heading">#</a></h2>
</section>
<section id="overview-of-functions-provided">
<span id="global"></span><h2>overview of functions provided<a class="headerlink" href="#overview-of-functions-provided" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="c1">// typedefs</span>

<span class="k">typedef</span> <span class="kt">float</span> <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1a3455cab03087949fd428a31cf302f98b"><span class="std std-ref">real_sp_</span></a><span></span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">double</span> <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span><span class="p">;</span>

<span class="c1">// structs</span>

<span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="p">;</span>
<span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-inform-type"><span class="std std-ref">lstr_inform_type</span></a><span></span><span class="p">;</span>

<span class="c1">// global functions</span>

<span class="kt">void</span> <a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1ae423bf7ffc77c89f461448ca1f5c286c"><span class="std std-ref">lstr_initialize</span></a><span></span><span class="p">(</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">status</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1a3d3fa989fe4c3b40cd7e296249d2205d"><span class="std std-ref">lstr_read_specfile</span></a><span></span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="n">specfile</span><span class="p">[]</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1a1a8ad63d944dc046fd2040554d6d01e5"><span class="std std-ref">lstr_import_control</span></a><span></span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">status</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1af3355e5a8df63a9c7173eb974a1e7562"><span class="std std-ref">lstr_solve_problem</span></a><span></span><span class="p">(</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">status</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">m</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">radius</span><span class="p">,</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">x</span><span class="p">[],</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">u</span><span class="p">[],</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">v</span><span class="p">[]</span>
<span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1a5929f00ea00af253ede33a6749451481"><span class="std std-ref">lstr_information</span></a><span></span><span class="p">(</span><span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-inform-type"><span class="std std-ref">lstr_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span><span class="p">,</span> <span class="kt">int</span><span class="o">*</span> <span class="n">status</span><span class="p">);</span>

<span class="kt">void</span> <a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1aa198189942e179e52699e1fedfcdf9d1"><span class="std std-ref">lstr_terminate</span></a><span></span><span class="p">(</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-inform-type"><span class="std std-ref">lstr_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span>
<span class="p">);</span></pre>
</section>
<section id="typedefs">
<span id="details-global"></span><h2>typedefs<a class="headerlink" href="#typedefs" title="Permalink to this heading">#</a></h2>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-precision-8h-1a3455cab03087949fd428a31cf302f98b"><span id="index-0"></span><span></span><span class="k">typedef</span> <span class="kt">float</span> <span class="n">real_sp_</span></pre>
<p><code class="docutils literal notranslate"><span class="pre">real_sp_</span></code> is real single precision</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span id="index-1"></span><span></span><span class="k">typedef</span> <span class="kt">double</span> <span class="n">real_wp_</span></pre>
<p><code class="docutils literal notranslate"><span class="pre">real_wp_</span></code> is the real working precision used</p>
</section>
<section id="function-calls">
<h2>function calls<a class="headerlink" href="#function-calls" title="Permalink to this heading">#</a></h2>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-lstr-8h-1ae423bf7ffc77c89f461448ca1f5c286c"><span id="index-2"></span><span></span><span class="kt">void</span> <span class="n">lstr_initialize</span><span class="p">(</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">status</span>
<span class="p">)</span></pre>
<p>Set default control values and initialize private data</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a struct containing control information (see <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type int, that gives the exit status from the package. Possible values are (currently):</p>
<ul class="simple">
<li><ol class="arabic simple" start="0">
<li><p>The import was succesful.</p></li>
</ol>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-lstr-8h-1a3d3fa989fe4c3b40cd7e296249d2205d"><span id="index-3"></span><span></span><span class="kt">void</span> <span class="n">lstr_read_specfile</span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="n">specfile</span><span class="p">[]</span>
<span class="p">)</span></pre>
<p>Read the content of a specification file, and assign values associated with given keywords to the corresponding control parameters. By default, the spcification file will be named RUNLSTR.SPC and lie in the current directory. Refer to Table 2.1 in the fortran documentation provided in $GALAHAD/doc/lstr.pdf for a list of keywords that may be set.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a struct containing control information (see <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>specfile</p></td>
<td><p>is a character string containing the name of the specification file</p></td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-lstr-8h-1a1a8ad63d944dc046fd2040554d6d01e5"><span id="index-4"></span><span></span><span class="kt">void</span> <span class="n">lstr_import_control</span><span class="p">(</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">status</span>
<span class="p">)</span></pre>
<p>Import control parameters prior to solution.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>control</p></td>
<td><p>is a struct whose members provide control paramters for the remaining prcedures (see <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type int, that gives the exit status from the package. Possible values are (currently):</p>
<ul class="simple">
<li><ol class="arabic simple">
<li><p>The import was succesful, and the package is ready for the solve phase</p></li>
</ol>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-lstr-8h-1af3355e5a8df63a9c7173eb974a1e7562"><span id="index-5"></span><span></span><span class="kt">void</span> <span class="n">lstr_solve_problem</span><span class="p">(</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">status</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">m</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">radius</span><span class="p">,</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">x</span><span class="p">[],</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">u</span><span class="p">[],</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">v</span><span class="p">[]</span>
<span class="p">)</span></pre>
<p>Solve the trust-region least-squares problem using reverse communication.</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>status</p></td>
<td><p>is a scalar variable of type int, that gives the entry and exit status from the package.</p>
<p>This must be set to</p>
<ul class="simple">
<li><ol class="arabic simple">
<li><p>on initial entry. Set u (below) to <span class="math notranslate nohighlight">\(b\)</span> for this entry.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="5">
<li><p>the iteration is to be restarted with a smaller radius but with all other data unchanged. Set u (below) to <span class="math notranslate nohighlight">\(b\)</span> for this entry.</p></li>
</ol>
</li>
</ul>
<p>Possible exit values are:</p>
<ul>
<li><ol class="arabic simple" start="0">
<li><p>the solution has been found</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>The user must perform the operation</p></li>
</ol>
<div class="math notranslate nohighlight">
\[u := u + A v,\]</div>
<dl class="simple">
<dt>n</dt><dd><p>u := u + A v,</p>
</dd>
</dl>
<p>n and recall the function. The vectors <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are available in the arrays u and v (below) respectively, and the result <span class="math notranslate nohighlight">\(u\)</span> must overwrite the content of u. No argument except u should be altered before recalling the function</p>
</li>
<li><ol class="arabic simple" start="3">
<li><p>The user must perform the operation</p></li>
</ol>
<div class="math notranslate nohighlight">
\[v := v + A^T u,\]</div>
<dl class="simple">
<dt>n</dt><dd><p>v := v + A^T u,</p>
</dd>
</dl>
<p>n and recall the function. The vectors <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are available in the arrays u and v (below) respectively, and the result <span class="math notranslate nohighlight">\(v\)</span> must overwrite the content of v. No argument except v should be altered before recalling the function</p>
</li>
<li><ol class="arabic simple" start="4">
<li><p>The user must reset u (below) to <span class="math notranslate nohighlight">\(b\)</span> are recall the function. No argument except u should be altered before recalling the function</p></li>
</ol>
</li>
<li><p>-1. an array allocation has failed</p></li>
<li><p>-2. an array deallocation has failed</p></li>
<li><p>-3. one or more of n, m or weight violates allowed bounds</p></li>
<li><p>-18. the iteration limit has been exceeded</p></li>
<li><p>-25. status is negative on entry</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>m</p></td>
<td><p>is a scalar variable of type int, that holds the number of equations (i.e., rows of <span class="math notranslate nohighlight">\(A\)</span>), <span class="math notranslate nohighlight">\(m &gt; 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>is a scalar variable of type int, that holds the number of variables (i.e., columns of <span class="math notranslate nohighlight">\(A\)</span>), <span class="math notranslate nohighlight">\(n &gt; 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>radius</p></td>
<td><p>is a scalar of type double, that holds the trust-region radius, <span class="math notranslate nohighlight">\(\Delta &gt; 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>is a one-dimensional array of size n and type double, that holds the solution <span class="math notranslate nohighlight">\(x\)</span>. The j-th component of x, j = 0, … , n-1, contains <span class="math notranslate nohighlight">\(x_j\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>u</p></td>
<td><p>is a one-dimensional array of size m and type double, that should be used and reset appropriately when status = 1 to 5 as directed by status.</p></td>
</tr>
<tr class="row-even"><td><p>v</p></td>
<td><p>is a one-dimensional array of size n and type double, that should be used and reset appropriately when status = 1 to 5 as directed by status.</p></td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-lstr-8h-1a5929f00ea00af253ede33a6749451481"><span id="index-6"></span><span></span><span class="kt">void</span> <span class="n">lstr_information</span><span class="p">(</span><span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span> <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-inform-type"><span class="std std-ref">lstr_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span><span class="p">,</span> <span class="kt">int</span><span class="o">*</span> <span class="n">status</span><span class="p">)</span></pre>
<p>Provides output information</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>inform</p></td>
<td><p>is a struct containing output information (see <a class="reference internal" href="#doxid-structlstr-inform-type"><span class="std std-ref">lstr_inform_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>is a scalar variable of type int, that gives the exit status from the package. Possible values are (currently):</p>
<ul class="simple">
<li><ol class="arabic simple" start="0">
<li><p>The values were recorded succesfully</p></li>
</ol>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-galahad-lstr-8h-1aa198189942e179e52699e1fedfcdf9d1"><span id="index-7"></span><span></span><span class="kt">void</span> <span class="n">lstr_terminate</span><span class="p">(</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">data</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a><span></span><span class="o">*</span> <span class="n">control</span><span class="p">,</span>
    <span class="k">struct</span> <a class="reference internal" href="#doxid-structlstr-inform-type"><span class="std std-ref">lstr_inform_type</span></a><span></span><span class="o">*</span> <span class="n">inform</span>
<span class="p">)</span></pre>
<p>Deallocate all internal private storage</p>
<p class="rubric">Parameters:</p>
<table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>data</p></td>
<td><p>holds private internal data</p></td>
</tr>
<tr class="row-even"><td><p>control</p></td>
<td><p>is a struct containing control information (see <a class="reference internal" href="#doxid-structlstr-control-type"><span class="std std-ref">lstr_control_type</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>inform</p></td>
<td><p>is a struct containing output information (see <a class="reference internal" href="#doxid-structlstr-inform-type"><span class="std std-ref">lstr_inform_type</span></a>)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="available-structures">
<h2>available structures<a class="headerlink" href="#available-structures" title="Permalink to this heading">#</a></h2>
</section>
<section id="lstr-control-type-structure">
<span id="doxid-structlstr-control-type"></span><span id="index-8"></span><h2>lstr_control_type structure<a class="headerlink" href="#lstr-control-type-structure" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="cp">#include</span> <span class="cpf">&lt;galahad_lstr.h&gt;</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">lstr_control_type</span> <span class="p">{</span>
    <span class="c1">// fields</span>

    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a6e8421b34d6b85dcb33c1dd0179efbb3"><span class="std std-ref">f_indexing</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a11614f44ef4d939bdd984953346a7572"><span class="std std-ref">error</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1aa8000eda101cade7c6c4b913fce0cc9c"><span class="std std-ref">out</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a12dae630bd8f5d2d00f6a86d652f5c81"><span class="std std-ref">print_level</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1ae0eb21dc79b53664e45ce07c9109b3aa"><span class="std std-ref">start_print</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a9a3d9960a04602d2a18009c82ae2124e"><span class="std std-ref">stop_print</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a31edaef6b722ef2721633484405a649b"><span class="std std-ref">print_gap</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1aa385135920896920e910796e164637eb"><span class="std std-ref">itmin</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1ac8da2a7f67eddd46d6b08817471e3063"><span class="std std-ref">itmax</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a884ad04ad051e3dbe3d05f56c8b411c8"><span class="std std-ref">itmax_on_boundary</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a3a99fb44bd37e908c09195de8dc8e455"><span class="std std-ref">bitmax</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-control-type-1ac24a274f1682ee791e15979f6c4341e1"><span class="std std-ref">extra_vectors</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-control-type-1ae3103abf29cabc33010d53428da2f2fc"><span class="std std-ref">stop_relative</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-control-type-1a16e43fc1e4c1e1b4c671a9b1fbbcd3e6"><span class="std std-ref">stop_absolute</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-control-type-1a3a722628453f92a1fb510e15f0bd71bb"><span class="std std-ref">fraction_opt</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-control-type-1a935b207da67876f712cee43d1e055d75"><span class="std std-ref">time_limit</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a33316102c81d1b21da04eb70850aae95"><span class="std std-ref">steihaug_toint</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a957fc1f4f26eeef3b0951791ff972e8d"><span class="std std-ref">space_critical</span></a><span></span><span class="p">;</span>
    <span class="kt">bool</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a58a2c67fad6e808e8365eff67700cba5"><span class="std std-ref">deallocate_error_fatal</span></a><span></span><span class="p">;</span>
    <span class="kt">char</span> <a class="reference internal" href="#doxid-structlstr-control-type-1a1dc05936393ba705f516a0c275df4ffc"><span class="std std-ref">prefix</span></a><span></span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
<span class="p">};</span></pre>
</section>
<section id="detailed-documentation">
<span id="details-structlstr-control-type"></span><h2>detailed documentation<a class="headerlink" href="#detailed-documentation" title="Permalink to this heading">#</a></h2>
<p>control derived type as a C struct</p>
<section id="components">
<h3>components<a class="headerlink" href="#components" title="Permalink to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a6e8421b34d6b85dcb33c1dd0179efbb3"><span id="index-9"></span><span></span><span class="kt">bool</span> <span class="n">f_indexing</span></pre>
<p>use C or Fortran sparse matrix indexing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a11614f44ef4d939bdd984953346a7572"><span id="index-10"></span><span></span><span class="kt">int</span> <span class="n">error</span></pre>
<p>error and warning diagnostics occur on stream error</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1aa8000eda101cade7c6c4b913fce0cc9c"><span id="index-11"></span><span></span><span class="kt">int</span> <span class="n">out</span></pre>
<p>general output occurs on stream out</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a12dae630bd8f5d2d00f6a86d652f5c81"><span id="index-12"></span><span></span><span class="kt">int</span> <span class="n">print_level</span></pre>
<p>the level of output required is specified by print_level</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1ae0eb21dc79b53664e45ce07c9109b3aa"><span id="index-13"></span><span></span><span class="kt">int</span> <span class="n">start_print</span></pre>
<p>any printing will start on this iteration</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a9a3d9960a04602d2a18009c82ae2124e"><span id="index-14"></span><span></span><span class="kt">int</span> <span class="n">stop_print</span></pre>
<p>any printing will stop on this iteration</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a31edaef6b722ef2721633484405a649b"><span id="index-15"></span><span></span><span class="kt">int</span> <span class="n">print_gap</span></pre>
<p>the number of iterations between printing</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1aa385135920896920e910796e164637eb"><span id="index-16"></span><span></span><span class="kt">int</span> <span class="n">itmin</span></pre>
<p>the minimum number of iterations allowed (-ve = no bound)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1ac8da2a7f67eddd46d6b08817471e3063"><span id="index-17"></span><span></span><span class="kt">int</span> <span class="n">itmax</span></pre>
<p>the maximum number of iterations allowed (-ve = no bound)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a884ad04ad051e3dbe3d05f56c8b411c8"><span id="index-18"></span><span></span><span class="kt">int</span> <span class="n">itmax_on_boundary</span></pre>
<p>the maximum number of iterations allowed once the boundary has been encountered (-ve = no bound)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a3a99fb44bd37e908c09195de8dc8e455"><span id="index-19"></span><span></span><span class="kt">int</span> <span class="n">bitmax</span></pre>
<p>the maximum number of Newton inner iterations per outer iteration allowe (-ve = no bound)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1ac24a274f1682ee791e15979f6c4341e1"><span id="index-20"></span><span></span><span class="kt">int</span> <span class="n">extra_vectors</span></pre>
<p>the number of extra work vectors of length n used</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1ae3103abf29cabc33010d53428da2f2fc"><span id="index-21"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">stop_relative</span></pre>
<p>the iteration stops successfully when <span class="math notranslate nohighlight">\(\|A^Tr\|\)</span> is less than max( stop_relative * <span class="math notranslate nohighlight">\(\|A^Tr_{initial} \|\)</span>, stop_absolute )</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a16e43fc1e4c1e1b4c671a9b1fbbcd3e6"><span id="index-22"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">stop_absolute</span></pre>
<p>see stop_relative</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a3a722628453f92a1fb510e15f0bd71bb"><span id="index-23"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">fraction_opt</span></pre>
<p>an estimate of the solution that gives at least .fraction_opt times the optimal objective value will be found</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a935b207da67876f712cee43d1e055d75"><span id="index-24"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">time_limit</span></pre>
<p>the maximum elapsed time allowed (-ve means infinite)</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a33316102c81d1b21da04eb70850aae95"><span id="index-25"></span><span></span><span class="kt">bool</span> <span class="n">steihaug_toint</span></pre>
<p>should the iteration stop when the Trust-region is first encountered?</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a957fc1f4f26eeef3b0951791ff972e8d"><span id="index-26"></span><span></span><span class="kt">bool</span> <span class="n">space_critical</span></pre>
<p>if .space_critical true, every effort will be made to use as little space as possible. This may result in longer computation time</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a58a2c67fad6e808e8365eff67700cba5"><span id="index-27"></span><span></span><span class="kt">bool</span> <span class="n">deallocate_error_fatal</span></pre>
<p>if .deallocate_error_fatal is true, any array/pointer deallocation error will terminate execution. Otherwise, computation will continue</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-control-type-1a1dc05936393ba705f516a0c275df4ffc"><span id="index-28"></span><span></span><span class="kt">char</span> <span class="n">prefix</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span></pre>
<p>all output lines will be prefixed by .prefix(2:LEN(TRIM(.prefix))-1) where .prefix contains the required string enclosed in quotes, e.g. “string” or ‘string’</p>
</section>
</section>
<section id="lstr-inform-type-structure">
<span id="doxid-structlstr-inform-type"></span><span id="index-29"></span><h2>lstr_inform_type structure<a class="headerlink" href="#lstr-inform-type-structure" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="cp">#include</span> <span class="cpf">&lt;galahad_lstr.h&gt;</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">lstr_inform_type</span> <span class="p">{</span>
    <span class="c1">// fields</span>

    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a6e27f49150e9a14580fb313cc2777e00"><span class="std std-ref">status</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a4335d5f44067aca76d5fff71eeb7d381"><span class="std std-ref">alloc_status</span></a><span></span><span class="p">;</span>
    <span class="kt">char</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a19ba64e8444ca3672abd157e4f1303a3"><span class="std std-ref">bad_alloc</span></a><span></span><span class="p">[</span><span class="mi">81</span><span class="p">];</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1aab6f168571c2073e01e240524b8a3da0"><span class="std std-ref">iter</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1aa69f8ea5f07782fd8ad0318f87202ac4"><span class="std std-ref">iter_pass2</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a0c5347be8391fbb23d728cebe0f3a5a8"><span class="std std-ref">biters</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a6fe473492218a28f33e53f014c741e81"><span class="std std-ref">biter_min</span></a><span></span><span class="p">;</span>
    <span class="kt">int</span> <a class="reference internal" href="#doxid-structlstr-inform-type-1aaa032644e73bb5bbc6092733db7f013b"><span class="std std-ref">biter_max</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-inform-type-1ac8bfb1ed777319ef92b7039c66f9a9b0"><span class="std std-ref">multiplier</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a32b3ba51ed1b0d7941f34e736da26ae3"><span class="std std-ref">x_norm</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-inform-type-1ae908410fabf891cfd89626c3605c38ca"><span class="std std-ref">r_norm</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a0dc3a69b13123a76ec6ee7dd031eadff"><span class="std std-ref">Atr_norm</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <a class="reference internal" href="#doxid-structlstr-inform-type-1a0c9f077f6c3bc52c519c2045c0578b22"><span class="std std-ref">biter_mean</span></a><span></span><span class="p">;</span>
<span class="p">};</span></pre>
</section>
<section id="details-structlstr-inform-type">
<span id="id7"></span><h2>detailed documentation<a class="headerlink" href="#details-structlstr-inform-type" title="Permalink to this heading">#</a></h2>
<p>inform derived type as a C struct</p>
<section id="id8">
<h3>components<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a6e27f49150e9a14580fb313cc2777e00"><span id="index-30"></span><span></span><span class="kt">int</span> <span class="n">status</span></pre>
<p>return status. See <a class="reference internal" href="lstr_functions.html#doxid-galahad-lstr-8h-1af3355e5a8df63a9c7173eb974a1e7562"><span class="std std-ref">lstr_solve_problem</span></a> for details</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a4335d5f44067aca76d5fff71eeb7d381"><span id="index-31"></span><span></span><span class="kt">int</span> <span class="n">alloc_status</span></pre>
<p>the status of the last attempted allocation/deallocation</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a19ba64e8444ca3672abd157e4f1303a3"><span id="index-32"></span><span></span><span class="kt">char</span> <span class="n">bad_alloc</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span></pre>
<p>the name of the array for which an allocation/deallocation error occurred</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1aab6f168571c2073e01e240524b8a3da0"><span id="index-33"></span><span></span><span class="kt">int</span> <span class="n">iter</span></pre>
<p>the total number of iterations required</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1aa69f8ea5f07782fd8ad0318f87202ac4"><span id="index-34"></span><span></span><span class="kt">int</span> <span class="n">iter_pass2</span></pre>
<p>the total number of pass-2 iterations required if the solution lies on the trust-region boundary</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a0c5347be8391fbb23d728cebe0f3a5a8"><span id="index-35"></span><span></span><span class="kt">int</span> <span class="n">biters</span></pre>
<p>the total number of inner iterations performed</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a6fe473492218a28f33e53f014c741e81"><span id="index-36"></span><span></span><span class="kt">int</span> <span class="n">biter_min</span></pre>
<p>the smallest number of inner iterations performed during an outer iteration</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1aaa032644e73bb5bbc6092733db7f013b"><span id="index-37"></span><span></span><span class="kt">int</span> <span class="n">biter_max</span></pre>
<p>the largestt number of inner iterations performed during an outer iteration</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1ac8bfb1ed777319ef92b7039c66f9a9b0"><span id="index-38"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">multiplier</span></pre>
<p>the Lagrange multiplier, <span class="math notranslate nohighlight">\(\lambda\)</span>, corresponding to the trust-region constraint</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a32b3ba51ed1b0d7941f34e736da26ae3"><span id="index-39"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">x_norm</span></pre>
<p>the Euclidean norm of <span class="math notranslate nohighlight">\(x\)</span></p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1ae908410fabf891cfd89626c3605c38ca"><span id="index-40"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">r_norm</span></pre>
<p>the Euclidean norm of <span class="math notranslate nohighlight">\(Ax-b\)</span></p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a0dc3a69b13123a76ec6ee7dd031eadff"><span id="index-41"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">Atr_norm</span></pre>
<p>the Euclidean norm of <span class="math notranslate nohighlight">\(A^T (Ax-b) + \lambda x\)</span></p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-structlstr-inform-type-1a0c9f077f6c3bc52c519c2045c0578b22"><span id="index-42"></span><a class="reference internal" href="trs_functions.html#doxid-galahad-precision-8h-1ab82133d435678ff159433d2e50cf295e"><span class="std std-ref">real_wp_</span></a><span></span> <span class="n">biter_mean</span></pre>
<p>the average number of inner iterations performed during an outer</p>
<p>iteration</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></div>
</div>
</section>
</section>
<section id="example-calls">
<span id="doxid-index-lstr-examples"></span><h2>example calls<a class="headerlink" href="#example-calls" title="Permalink to this heading">#</a></h2>
<p>This is an example of how to use the package to … ;
the code is available in $GALAHAD/src/lstr/C/lstrt.c .
A variety of supported Hessian and constraint matrix storage formats are shown.</p>
<p>Notice that C-style indexing is used, and that this is flaggeed by setting
<code class="docutils literal notranslate"><span class="pre">control.f_indexing</span></code> to <code class="docutils literal notranslate"><span class="pre">false</span></code>. The floating-point type <code class="docutils literal notranslate"><span class="pre">real_wp_</span></code>
is set in <code class="docutils literal notranslate"><span class="pre">galahad_precision.h</span></code> to <code class="docutils literal notranslate"><span class="pre">double</span></code> by default, but to <code class="docutils literal notranslate"><span class="pre">float</span></code>
if the preproccesor variable <code class="docutils literal notranslate"><span class="pre">GALAHAD_SINGLE</span></code> is defined.</p>
<div class="code C highlight-default notranslate"><div class="highlight"><pre><span></span>/* lstrt.c */
/* Full test for the LSTR C interface */

#include &lt;stdio.h&gt;
#include &lt;math.h&gt;
#include &quot;galahad_precision.h&quot;
#include &quot;galahad_cfunctions.h&quot;
#include &quot;galahad_lstr.h&quot;

int main(void) {

    // Derived types
    void *data;
    struct lstr_control_type control;
    struct lstr_inform_type inform;

    // Set problem data
    int n = 50; // dimensions
    int m = 2 * n;

    int status;
    real_wp_ radius;
    real_wp_ x[n];
    real_wp_ u[m];
    real_wp_ v[n];

    // Initialize lstr
    lstr_initialize( &amp;data, &amp;control, &amp;status );

    // resolve with a smaller radius ?
    for( int new_radius=0; new_radius &lt;= 1; new_radius++){
      if ( new_radius == 0 ){ // original radius
         radius = 1.0;
         status = 1;
      } else { // smaller radius
         radius = 0.1;
         status = 5;
      }
      control.print_level = 0;
      lstr_import_control( &amp;control, &amp;data, &amp;status );

      for( int i = 0; i &lt; m; i++) u[i] = 1.0; // b = 1

      // iteration loop to find the minimizer with A^T = (I:diag(1:n))
      while(true){ // reverse-communication loop
        lstr_solve_problem( &amp;data, &amp;status, m, n, radius, x, u, v );
        if ( status == 0 ) { // successful termination
            break;
        } else if ( status &lt; 0 ) { // error exit
            break;
        } else if ( status == 2 ) { // form u &lt;- u + A * v
          for( int i = 0; i &lt; n; i++) {
            u[i] = u[i] + v[i];
            u[n+i] = u[n+i] + (i+1)*v[i];
          }
        } else if ( status == 3 ) { // form v &lt;- v + A^T * u
          for( int i = 0; i &lt; n; i++) v[i] = v[i] + u[i] + (i+1) * u[n+i];
        } else if ( status == 4 ) { // restart
          for( int i = 0; i &lt; m; i++) u[i] = 1.0;
        }else{
            printf(&quot; the value %1i of status should not occur\n&quot;,
              status);
            break;
        }
      }
      lstr_information( &amp;data, &amp;inform, &amp;status );
      printf(&quot;%1i lstr_solve_problem exit status = %i,&quot;
           &quot; f = %.2f\n&quot;, new_radius, inform.status, inform.r_norm );
    }
   // Delete internal workspace
   lstr_terminate( &amp;data, &amp;control, &amp;inform );
}
</pre></div>
</div>
<p>This is the same example, but now fortran-style indexing is used;
the code is available in $GALAHAD/src/lstr/C/lstrtf.c .</p>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="struct_llst_time_type.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">llst_time_type structure</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="lstr_functions.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">overview of functions provided</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#purpose">
   purpose
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method">
   method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   references
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-function-calls">
   introduction to function calls
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#callable-functions">
   callable functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-of-functions-provided">
   overview of functions provided
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typedefs">
   typedefs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#function-calls">
   function calls
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#available-structures">
   available structures
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lstr-control-type-structure">
   lstr_control_type structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detailed-documentation">
   detailed documentation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#components">
     components
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lstr-inform-type-structure">
   lstr_inform_type structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#details-structlstr-inform-type">
   detailed documentation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     components
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-calls">
   example calls
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="_sources/lstr.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright Gould/Orban/Toint, for GALAHAD productions, GALAHAD 4 C/Python interfaces copyright Fowkes/Gould.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>