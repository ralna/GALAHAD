#  Main body of the installation makefile for dummy and basic GALAHAD packages

#  Nick Gould, for GALAHAD productions
#  This version: 2023-05-18

#  include standard GALAHAD makefile definitions

include $(GALAHAD)/src/makedefs/definitions

#  compilation agenda

DUMMYS = kinds_silent clock_silent extend_silent symbols_silent \
         dummy_silent cutest_dummy_silent dummy_hsl_silent dummy_hsl_c_silent \
         dummy_spral_silent blas_silent lapack_silent blas_interface_silent \
         lapack_interface_silent metis_silent \
         pardiso_silent mkl_pardiso_silent wsmp_silent \
         pastix_silent mpi_silent mumps_silent umfpack_silent \
         string_silent buildspec_silent

BASICS = $(DUMMYS) zd11_silent smt_silent space_silent \
         specfile_silent sort_silent norms_silent

#  main compilations and runs

all: basic

#  all of the basic packages

basic_silent: $(BASICS)

basic: basic_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: basic packages ($(PRECIS) $(SUCC)"
basic_single: $(BASICS)
	$(RANLIB) $(LGS)
basic_double: $(BASICS)
	$(RANLIB) $(LGD)

dummys_silent: $(DUMMYS)

dummys: dummy_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: dummy packages ($(PRECIS) $(SUCC)"
dummys_single: $(DUMMYS)
	$(RANLIB) $(LGS)
dummys_double: $(DUMMYS)
	$(RANLIB) $(LGD)

#  kinds package

kinds_silent:
	( cd $(GALAHAD)/src/kinds ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) kinds_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/kinds )

#  clock package

clock_silent:
	( cd $(GALAHAD)/src/clock ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clock_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/clock )

#  extend package

extend_silent:
	( cd $(GALAHAD)/src/extend ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) extend_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/extend )

#  symbols package

symbols_silent:
	( cd $(GALAHAD)/src/symbols ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) symbols_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/symbols )

#  string package

string_silent:
	( cd $(GALAHAD)/src/string ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) string_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/string )

#  space package

space_silent:
	( cd $(GALAHAD)/src/space ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) space_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/space )

#  specfile package

specfile_silent:
	( cd $(GALAHAD)/src/specfile ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) specfile_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/specfile )

#  buildspec package

buildspec_silent:
	( cd $(GALAHAD)/src/buildspec ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) buildspec_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/buildspec )

#  sort package

sort_silent:
	( cd $(GALAHAD)/src/sort ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) sort_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/sort )

#  norms package

norms_silent:
	( cd $(GALAHAD)/src/norms ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) norms_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/norms )

#  zd11 package

zd11_silent:
	( cd $(GALAHAD)/src/zd11 ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) zd11_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/zd11 )

#  smt package

smt_silent:
	( cd $(GALAHAD)/src/smt ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) smt_silent \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/smt )

#  blas packages

blas_silent: $(BLG)(blas_$(PRECIS).o)
blas: $(BLG)(blas_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: BLAS compiled successfully"

blas.o: $(BLG)(blas_$(PRECIS).o)

$(BLG)(blas_$(PRECIS).o): ../lapack/blas.f
	@printf ' %-9s %-15s\t\t' "Compiling" "blas  "
	$(CP) ../lapack/blas.f $(OBJ)/blas.f90
	cd $(OBJ); $(FORTRAN) -o blas_$(PRECIS).o $(FFLAGS77) blas.f90
	cd $(OBJ); $(BARR) blas_$(PRECIS).o ; $(RM) blas.f90 blas_$(PRECIS).o
	$(RANLIB) $(BLG)
	@printf '[ OK ]\n'

#  lapack packages

lapack_silent: $(LLG)(lapack_$(PRECIS).o)
lapack: $(LLG)(lapack_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: LAPACK compiled successfully"

lapack.o: $(LLG)(lapack_$(PRECIS).o)

$(LLG)(lapack_$(PRECIS).o): ../lapack/lapack.f
	@printf ' %-9s %-15s\t\t' "Compiling" "lapack"
	$(CAT) ../lapack/lapack.f ../lapack/$(IEEECK)ieeeck.f > \
          $(OBJ)/lapack.f90
	cd $(OBJ); $(FORTRAN) -o lapack_$(PRECIS).o $(FFLAGS77) lapack.f90
	cd $(OBJ); $(LARR) lapack_$(PRECIS).o ; \
          $(RM) lapack.f90 lapack_$(PRECIS).o
	$(RANLIB) $(LLG)
	@printf '[ OK ]\n'

#  dummy package

dummy_silent: $(DLG)(dummy_$(PRECIS).o)
dummy: $(DLG)(dummy_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: DUMMY compiled successfully"

dummy.o: $(DLG)(dummy_$(PRECIS).o)

$(DLG)(dummy_$(PRECIS).o): ../dum/dummy.f
	@printf ' %-9s %-15s\t\t' "Compiling" "dummy"
	$(CP) ../dum/dummy.f $(OBJ)/dummy.f90
	cd $(OBJ); $(FORTRAN) -o dummy_$(PRECIS).o $(FFLAGS77) dummy.f90
	cd $(OBJ); $(DARR) dummy_$(PRECIS).o ; $(RM) dummy.f90 dummy_$(PRECIS).o
	$(RANLIB) $(DLG)
	@printf '[ OK ]\n'

# cutest_dummy package

cutest_dummy_silent: $(CDLG)(cutest_dummy_$(PRECIS).o)
cutest_dummy: $(CDLG)(cutest_dummy_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: CUTEST_DUMMY compiled successfully"

cutest_dummy.o: $(CDLG)(cutest_dummy_$(PRECIS).o)

$(CDLG)(cutest_dummy_$(PRECIS).o): ../dum/cutest_dummy.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "cutest_dummy"
	$(CUARR) ../dum/empty
	$(CP) ../dum/cutest_dummy.F90 $(OBJ)/cutest_dummy.F90
	cd $(OBJ); $(FORTRAN) -o cutest_dummy_$(PRECIS).o \
           $(FFLAGS) cutest_dummy.F90
	cd $(OBJ); $(CDARR) cutest_dummy_$(PRECIS).o ; \
           $(RM) cutest_dummy.F90 cutest_dummy_$(PRECIS).o
	$(RANLIB) $(CDLG)
	@printf '[ OK ]\n'

#  dummy_hsl package

dummy_hsl_silent: $(HLG)(dummy_hsl_$(PRECIS).o)
dummy_hsl: $(HLG)(dummy_hsl_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: DUMMY compiled successfully"

dummy_hsl.o: $(HLG)(dummy_hsl_$(PRECIS).o)

$(HLG)(dummy_hsl_$(PRECIS).o): ../dum/dummy_hsl.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "dummy_hsl"
	$(CP) ../dum/dummy_hsl.F90 $(OBJ)/dummy_hsl.F90
	cd $(OBJ); $(FORTRAN) -o dummy_hsl_$(PRECIS).o $(FFLAGSS) dummy_hsl.F90
	cd $(OBJ); $(HARR) dummy_hsl_$(PRECIS).o ; \
           $(RM) dummy_hsl.F90 dummy_hsl_$(PRECIS).o
	$(RANLIB) $(HLG)
	@printf '[ OK ]\n'

#  dummy_hsl c package

dummy_hsl_c_silent: $(HCLG)(dummy_hsl_c_$(PRECIS).o)
dummy_hsl_c: $(HCLG)(dummy_hsl_c_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: DUMMY compiled successfully"

dummy_hsl_c.o: $(HCLG)(dummy_hsl_c_$(PRECIS).o)

$(HCLG)(dummy_hsl_c_$(PRECIS).o): ../dum/dummy_hsl_c.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "dummy_hsl_c"
	$(CP) ../dum/dummy_hsl_c.F90 $(OBJ)/dummy_hsl_c.F90
	cd $(OBJ); $(FORTRAN) -o dummy_hsl_c_$(PRECIS).o \
                     $(FFLAGSS) dummy_hsl_c.F90
	cd $(OBJ); $(HCARR) dummy_hsl_c_$(PRECIS).o ; \
          $(RM) dummy_hsl_c.F90 dummy_hsl_c_$(PRECIS).o
	$(RANLIB) $(HCLG)
	@printf '[ OK ]\n'

#  dummy_spral package

dummy_spral_silent: $(RLG)(dummy_spral_$(PRECIS).o)
dummy_spral: $(RLG)(dummy_spral_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: DUMMY compiled successfully"

dummy_spral.o: $(RLG)(dummy_spral_$(PRECIS).o)

$(RLG)(dummy_spral_$(PRECIS).o): ../dum/dummy_spral.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "dummy_spral"
	$(CP) ../dum/dummy_spral.F90 $(OBJ)/dummy_spral.F90
	cd $(OBJ); $(FORTRAN) -o dummy_spral_$(PRECIS).o \
                     $(FFLAGSS) dummy_spral.F90
	cd $(OBJ); $(RARR) dummy_spral_$(PRECIS).o ; \
          $(RM) dummy_spral.F90 dummy_spral_$(PRECIS).o
	$(RANLIB) $(RLG)
	@printf '[ OK ]\n'

#  blas_interface package

blas_interface_silent: $(BLG)(blas_$(PRECIS).o) \
                         $(LG)(blas_interface_$(PRECIS).o)
blas_interface: $(BLG)(blas_$(PRECIS).o) $(LG)(blas_interface_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: BLAS_interface compiled successfully"

blas_interface.o: $(BLG)(blas_$(PRECIS).o) $(LG)(blas_interface_$(PRECIS).o)

$(LG)(blas_interface_$(PRECIS).o): ../lapack/blas_interface.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "blas_interface"
	$(CP) ../lapack/blas_interface.F90 $(OBJ)/blas_interface.F90
	cd $(OBJ); $(FORTRAN) -o blas_interface_$(PRECIS).o $(FFLAGSS) \
           blas_interface.F90 || \
         ( printf ' %-26s' "=> Disabling optimization " ; \
            $(FORTRAN) -o blas_interface_$(PRECIS).o $(FFLAGSN) \
             blas_interface.F90 )
	cd $(OBJ); $(ARR) blas_interface_$(PRECIS).o ; \
          $(RM) blas_interface.F90 blas_interface_$(PRECIS).o
	$(RANLIB) $(LG)
	$(RMARFILES) norms scu lstr lsrt l2rt sls sha
	@printf '[ OK ]\n'

#  lapack_interface package

lapack_interface_silent: $(LLG)(lapack_$(PRECIS).o) \
                           $(LG)(lapack_interface_$(PRECIS).o)
lapack_interface: $(LLG)(lapack_$(PRECIS).o) \
                    $(LG)(lapack_interface_$(PRECIS).o)
	@printf ' %-21s\n' "GALAHAD: LAPACK_interface compiled successfully"

lapack_interface.o: $(LLG)(lapack_$(PRECIS).o) \
                      $(LG)(lapack_interface_$(PRECIS).o)

$(LG)(lapack_interface_$(PRECIS).o): ../lapack/lapack_interface.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "lapack_interface"
	$(CP) ../lapack/lapack_interface.F90 $(OBJ)/lapack_interface.F90
	cd $(OBJ); $(FORTRAN) -o lapack_interface_$(PRECIS).o $(FFLAGSS) \
           lapack_interface.F90 || \
         ( printf ' %-26s' "=> Disabling optimization " ; \
            $(FORTRAN) -o lapack_interface_$(PRECIS).o $(FFLAGSN) \
              lapack_interface.F90 )
	cd $(OBJ); $(ARR) lapack_interface_$(PRECIS).o ; \
          $(RM) lapack_interface.F90 lapack_interface_$(PRECIS).o
	$(RANLIB) $(LG)
	$(RMARFILES) gltr glrt sls trs rqs sha
	@printf '[ OK ]\n'

#  all metis packages

metis_silent: metis_$(PRECIS)
metis: metis_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: metis ($(PRECIS) $(SUCC)"
metis_single: dummy_metis_single metis4_single metis5_single
metis_double: dummy_metis_double metis4_double metis5_double

#  dummy metis package

dummy_metis_silent: dummy_metis_$(PRECIS)
dummy_metis: dummy_metis_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: dummy_metis ($(PRECIS) $(SUCC)"
dummy_metis_single: symbols_silent $(MDLGS)(dummy_metis.o)
	$(RANLIB) $(MDLGS)
dummy_metis_double: symbols_silent $(MDLGD)(dummy_metis.o)
	$(RANLIB) $(MDLGD)

dummy_metis.o: $(MDLG)(dummy_metis.o)

$(MDLG)(dummy_metis.o): ../external/metis/dummy_metis.f90
	@printf ' %-9s %-15s\t\t' "Compiling" "dummy metis  "
	$(CP) ../external/metis/dummy_metis.f90 $(OBJ)/dummy_metis.f90
	cd $(OBJ); $(FORTRAN) -o dummy_metis.o $(FFLAGS) dummy_metis.f90
	cd $(OBJ); $(MDARR) dummy_metis.o ; $(RM) dummy_metis.f90 dummy_metis.o
	@printf '[ OK ]\n'

#  metis4 package

metis4_silent: metis4_$(PRECIS)
metis4: metis4_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: metis4 ($(PRECIS) $(SUCC)"
metis4_single: symbols_silent $(M4LGS)(metis4.o)
	$(RANLIB) $(M4LGS)
metis4_double: symbols_silent $(M4LGD)(metis4.o)
	$(RANLIB) $(M4LGD)

metis4.o: $(M4LG)(metis4.o)

$(M4LG)(metis4.o): ../external/metis/metis4.f90
	@printf ' %-9s %-15s\t\t' "Compiling" "metis4  "
	$(CP) ../external/metis/metis4.f90 $(OBJ)/metis4.f90
	cd $(OBJ); $(FORTRAN) -o metis4.o $(FFLAGS) metis4.f90
	cd $(OBJ); $(M4ARR) metis4.o ; $(RM) metis4.f90 metis4.o
	@printf '[ OK ]\n'

#  metis5 package

metis5_silent: metis5_$(PRECIS)
metis5: metis5_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: metis5 ($(PRECIS) $(SUCC)"
metis5_single: symbols_silent $(M5LGS)(metis5.o) $(M5LGS)(metis5_adapter.o)
	$(RANLIB) $(M5LGS)
metis5_double: symbols_silent $(M5LGD)(metis5.o) $(M5LGD)(metis5_adapter.o)
	$(RANLIB) $(M5LGD)

metis5.o: $(M5LG)(metis5.o)

$(M5LG)(metis5.o): ../external/metis/metis5.f90
	@printf ' %-9s %-15s\t\t' "Compiling" "metis5  "
	$(CP) ../external/metis/metis5.f90 $(OBJ)/metis5.f90
	cd $(OBJ); $(FORTRAN) -o metis5.o $(FFLAGS) metis5.f90
	cd $(OBJ); $(M5ARR) metis5.o ; $(RM) metis5.f90 metis5.o
	@printf '[ OK ]\n'

metis5_adapter.o: $(M5LG)(metis5_adapter.o)

$(M5LG)(metis5_adapter.o): ../external/metis/metis5_adapter.c
	@printf ' %-9s %-15s\t\t' "Compiling" "metis5_adapter  "
	$(CP) ../external/metis/metis5_adapter.c $(OBJ)/metis5_adapter.c
	cd $(OBJ); $(CC) -o metis5_adapter.o $(CFLAGS) metis5_adapter.c
	cd $(OBJ); $(M5ARR) metis5_adapter.o ; \
          $(RM) metis5_adapter.c metis5_adapter.o
	@printf '[ OK ]\n'

#  mpi package

mpi_silent:
	( cd ../external/mpi ; $(MAKE) -f \
           $(GALAHAD)/makefiles/$(VERSION) mpi_silent \
           PRECIS=$(PRECIS) PWD=$(PWD)/../external/mpi )

#  pastix package

pastix_silent:
	( cd ../external/pastix ; $(MAKE) -f \
           $(GALAHAD)/makefiles/$(VERSION) pastix_silent \
           PRECIS=$(PRECIS) PWD=$(PWD)/../external/pastix )

#  mumps package

mumps_silent:
	( cd ../external/mumps ; $(MAKE) -f \
           $(GALAHAD)/makefiles/$(VERSION) mumps_silent \
           PRECIS=$(PRECIS) PWD=$(PWD)/../external/mumps )

#  pardiso package

pardiso_silent:
	( cd ../external/pardiso ; $(MAKE) -f \
           $(GALAHAD)/makefiles/$(VERSION) pardiso_silent \
           PRECIS=$(PRECIS) PWD=$(PWD)/../external/pardiso )

#  mkl pardiso package

mkl_pardiso_silent:
	( cd ../external/mkl_pardiso ; $(MAKE) -f \
           $(GALAHAD)/makefiles/$(VERSION) mkl_pardiso_silent \
           PRECIS=$(PRECIS) PWD=$(PWD)/../external/mkl_pardiso )

#  umfpack package

umfpack_silent:
	( cd ../external/umfpack ; $(MAKE) -f \
           $(GALAHAD)/makefiles/$(VERSION) umfpack_silent \
           PRECIS=$(PRECIS) PWD=$(PWD)/../external/umfpack )

#  wsmp package

wsmp_silent:
	( cd ../external/wsmp ; $(MAKE) -f \
           $(GALAHAD)/makefiles/$(VERSION) wsmp_silent \
           PRECIS=$(PRECIS) PWD=$(PWD)/../external/wsmp )

#  symmetric linear solver

linearsolver_silent: linearsolver_silent_$(PRECIS)
linearsolver_silent_single: $($(LINEARSOLVERS))
linearsolver_silent_double: $($(LINEARSOLVERD))

linearsolver: linearsolver_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: $(LINEARSOLVER) ($(PRECIS) $(SUCC)"
linearsolver_single: $($(LINEARSOLVERS))
	$(RANLIB) $(LGS)
linearsolver_double: $($(LINEARSOLVERD))
	$(RANLIB) $(LGD)

#  unsymmetric linear solver

ulinearsolver_silent: ulinearsolver_silent_$(PRECIS)
ulinearsolver_silent_single: $($(ULINEARSOLVERS))
ulinearsolver_silent_double: $($(ULINEARSOLVERD))

ulinearsolver: ulinearsolver_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: $(ULINEARSOLVER) ($(PRECIS) $(SUCC)"
ulinearsolver_single: $($(ULINEARSOLVERS))
	$(RANLIB) $(LGS)
ulinearsolver_double: $($(ULINEARSOLVERD))
	$(RANLIB) $(LGD)

SSIDSS = symbols_silent $(RLGS)(ssids_single.o)
SSIDSD = symbols_silent $(RLGD)(ssids_double.o)

PARDISOS = symbols_silent $(PLGS)(pardiso.o)
PARDISOD = symbols_silent $(PLGD)(pardiso.o)

METISS = symbols_silent $(MLGS)(metis4.o)
METISD = symbols_silent $(MLGD)(metis4.o)

WSMPS = symbols_silent $(WLGS)(wsmp.o)
WSMPD = symbols_silent $(WLGD)(wsmp.o)

UMFPACKS = symbols_silent $(ULGS)(umfpack.o)
UMFPACKD = symbols_silent $(ULGD)(umfpack.o)

MUMPSS = symbols_silent $(MULGS)(mumps.o)
MUMPSD = symbols_silent $(MULGD)(mumps.o)

PASTIXS = symbols_silent $(PXLGS)(spmf.o) $(PXLGS)(pastixf.o)
PASTIXD = symbols_silent $(PXLGD)(spmf.o) $(PXLGD)(pastixf.o)

#  ssids

ssids_dum_silent: ssids_dum_silent_$(PRECIS)
ssids_dum_silent_single: $(SSIDSS)
	$(RANLIB) $(RLGS)
ssids_dum_silent_double: $(SSIDSD)
	$(RANLIB) $(RLGD)

ssids_dum: ssids_dum_$(PRECIS)
	@printf ' %-21s\n' "GALAHAD: $(SSIDS) ($(PRECIS) $(SUCC)"
ssids_dum_single: $(SSIDSS)
	$(RANLIB) $(RLGS)
ssids_dum_double: $(SSIDSD)
	$(RANLIB) $(RLGD)

ssids_silent:
	( cd ../ssids ; $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) \
            ssids_silent PRECIS=$(PRECIS) PWD=$(PWD)/../ssids )
ssids:
	( cd ../ssids ; $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) \
            ssids PRECIS=$(PRECIS) PWD=$(PWD)/../ssids )

ssidss.o: $(RLGS)(ssids_$(PRECIS).o)

$(RLGS)(ssids_$(PRECIS).o): ../dum/ssidss.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "ssidss_dum"
	$(CP) ../dum/ssidss.F90 $(OBJ)/ssids.F90
	cd $(OBJ); $(FORTRAN) -o ssids_$(PRECIS).o $(FFLAGS) ssids.F90
	cd $(OBJ); $(RARR) ssids_$(PRECIS).o ; $(RM) ssids.F90 ssids_$(PRECIS).o
	$(MVMODS)
	$(RMARFILE) sls_$(PRECIS).o
	$(RANLIB) $(RLGS)
	@printf '[ OK ]\n'

ssidsd.o: $(RLGD)(ssids_$(PRECIS).o)

$(RLGD)(ssids_$(PRECIS).o): ../dum/ssidsd.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "ssidsd_dum"
	$(CP) ../dum/ssidsd.F90 $(OBJ)/ssids.F90
	cd $(OBJ); $(FORTRAN) -o ssids_$(PRECIS).o $(FFLAGS) ssids.F90
	cd $(OBJ); $(RARR) ssids_$(PRECIS).o ; $(RM) ssids.F90 ssids_$(PRECIS).o
	$(MVMODS)
	$(RMARFILE) sls_$(PRECIS).o
	$(RANLIB) $(RLGD)
	@printf '[ OK ]\n'

ssids_ciface.o: $(CLG)(ssids_ciface.o)

$(CLG)(ssids_ciface.o): ../dum/C/ssids_ciface.F90
	@printf ' %-9s %-15s\t\t' "Compiling" "ssids_ciface"
	$(CP) ../dum/C/ssids_ciface.F90 $(OBJ)/ssids_ciface.F90
	cd $(OBJ) ; $(FORTRAN) -o ssids_ciface.o $(FFLAGS) \
                      ssids_ciface.F90
	cd $(OBJ) ; $(RARR) ssids_ciface.o ; \
                    $(RM) ssids_ciface.F90 ssids_ciface.o
	$(CRMARFILE) sls_ciface_$(PRECIS).o
	$(MVMODS)
	@printf '[ OK ]\n'

#  book keeping

clean:
	( cd $(GALAHAD)/src/clock ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/clock )
	( cd $(GALAHAD)/src/symbols ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/symbols )
	( cd $(GALAHAD)/src/string ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/string )
	( cd $(GALAHAD)/src/space ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/space )
	( cd $(GALAHAD)/src/specfile ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/specfile )
	( cd $(GALAHAD)/src/buildspec ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/buildspec )
	( cd $(GALAHAD)/src/sort ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/sort )
	( cd $(GALAHAD)/src/norms ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/norms )
	( cd $(GALAHAD)/src/zd11 ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/zd11 )
	( cd $(GALAHAD)/src/smt ; \
          $(MAKE) -f $(GALAHAD)/makefiles/$(VERSION) clean \
          PRECIS=$(PRECIS) PWD=$(GALAHAD)/src/smt  )
	@printf '[ OK ]\n'

cleanall:
	@printf ' %-14s\t\t' \
          "Removing all $(PRECIS) precision object and module files"
	$(RM) -r $(OBJ)/* $(MOD)/*
	@printf '[ OK ]\n'
